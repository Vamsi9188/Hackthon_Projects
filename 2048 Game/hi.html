<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2048 Game</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #faf8ef;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .container {
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            color: #776e65;
        }

        #game-board {
            width: 320px;
            height: 320px;
            background-color: #bbada0;
            padding: 10px;
            border-radius: 10px;
            position: relative;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 10px;
        }

        .tile {
            width: 100%;
            height: 100%;
            background-color: #cdc1b4;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            color: #776e65;
            font-weight: bold;
        }

        .tile[data-value="2"] { background-color: #eee4da; }
        .tile[data-value="4"] { background-color: #ede0c8; }
        .tile[data-value="8"] { background-color: #f2b179; color: #f9f6f2; }
        .tile[data-value="16"] { background-color: #f59563; color: #f9f6f2; }
        .tile[data-value="32"] { background-color: #f67c5f; color: #f9f6f2; }
        .tile[data-value="64"] { background-color: #f65e3b; color: #f9f6f2; }
        .tile[data-value="128"] { background-color: #edcf72; color: #f9f6f2; }
        .tile[data-value="256"] { background-color: #edcc61; color: #f9f6f2; }
        .tile[data-value="512"] { background-color: #edc850; color: #f9f6f2; }
        .tile[data-value="1024"] { background-color: #edc53f; color: #f9f6f2; }
        .tile[data-value="2048"] { background-color: #edc22e; color: #f9f6f2; }

        #game-info {
            margin-top: 20px;
        }

        #score {
            font-size: 1.5rem;
            font-weight: bold;
            color: #776e65;
        }

        #restart-btn {
            background-color: #8f7a66;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1rem;
            border-radius: 5px;
            cursor: pointer;
        }

        #restart-btn:hover {
            background-color: #776e65;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>2048 Game</h1>
        <div id="game-board">
            <!-- Tiles will be dynamically added here -->
        </div>
        <div id="game-info">
            <p>Score: <span id="score">0</span></p>
            <button id="restart-btn">Restart Game</button>
        </div>
    </div>
    <script>
        const gameBoard = document.getElementById('game-board');
        const scoreElement = document.getElementById('score');
        const restartButton = document.getElementById('restart-btn');

        let grid;
        let score = 0;

        function createBoard() {
            grid = [];
            for (let i = 0; i < 4; i++) {
                grid[i] = [];
                for (let j = 0; j < 4; j++) {
                    grid[i][j] = 0;
                    createTile(i, j, 0);
                }
            }
            addNewTile();
            addNewTile();
            updateBoard();
        }

        function createTile(row, col, value) {
            const tile = document.createElement('div');
            tile.className = 'tile';
            tile.dataset.row = row;
            tile.dataset.col = col;
            tile.dataset.value = value;
            gameBoard.appendChild(tile);
        }

        function updateBoard() {
            gameBoard.querySelectorAll('.tile').forEach(tile => {
                const row = tile.dataset.row;
                const col = tile.dataset.col;
                const value = grid[row][col];
                tile.dataset.value = value;
                tile.textContent = value > 0 ? value : '';
            });
            scoreElement.textContent = score;
        }

        function addNewTile() {
            const emptyTiles = [];
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    if (grid[i][j] === 0) {
                        emptyTiles.push({ row: i, col: j });
                    }
                }
            }

            if (emptyTiles.length === 0) return;

            const newTile = emptyTiles[Math.floor(Math.random() * emptyTiles.length)];
            grid[newTile.row][newTile.col] = Math.random() < 0.9 ? 2 : 4;
        }

        function moveTiles(direction) {
            let moved = false;
            if (direction === 'up' || direction === 'down') {
                for (let col = 0; col < 4; col++) {
                    let merged = [false, false, false, false];
                    for (let row = direction === 'up' ? 1 : 2; direction === 'up' ? row < 4 : row >= 0; direction === 'up' ? row++ : row--) {
                        if (grid[row][col] === 0) continue;
                        let targetRow = direction === 'up' ? row - 1 : row + 1;
                        while (targetRow >= 0 && targetRow < 4 && grid[targetRow][col] === 0) {
                            targetRow = direction === 'up' ? targetRow - 1 : targetRow + 1;
                        }
                        if (targetRow >= 0 && targetRow < 4 && grid[targetRow][col] === grid[row][col] && !merged[targetRow]) {
                            grid[targetRow][col] *= 2;
                            grid[row][col] = 0;
                            score += grid[targetRow][col];
                            merged[targetRow] = true;
                            moved = true;
                        } else {
                            targetRow = direction === 'up' ? targetRow + 1 : targetRow - 1;
                            if (targetRow !== row) {
                                grid[targetRow][col] = grid[row][col];
                                grid[row][col] = 0;
                                moved = true;
                            }
                        }
                    }
                }
            } else if (direction === 'left' || direction === 'right') {
                for (let row = 0; row < 4; row++) {
                    let merged = [false, false, false, false];
                    for (let col = direction === 'left' ? 1 : 2; direction === 'left' ? col < 4 : col >= 0; direction === 'left' ? col++ : col--) {
                        if (grid[row][col] === 0) continue;
                        let targetCol = direction === 'left' ? col - 1 : col + 1;
                        while (targetCol >= 0 && targetCol < 4 && grid[row][targetCol] === 0) {
                            targetCol = direction === 'left' ? targetCol - 1 : targetCol + 1;
                        }
                        if (targetCol >= 0 && targetCol < 4 && grid[row][targetCol] === grid[row][col] && !merged[targetCol]) {
                            grid[row][targetCol] *= 2;
                            grid[row][col] = 0;
                            score += grid[row][targetCol];
                            merged[targetCol] = true;
                            moved = true;
                        } else {
                            targetCol = direction === 'left' ? targetCol + 1 : targetCol - 1;
                            if (targetCol !== col) {
                                grid[row][targetCol] = grid[row][col];
                                grid[row][col] = 0;
                                moved = true;
                            }
                        }
                    }
                }
            }

            if (moved) {
                addNewTile();
                updateBoard();
                if (checkGameOver()) {
                    alert('Game Over! Final Score: ' + score);
                    restartGame();
                }
            }
        }

        function checkGameOver() {
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    if (grid[i][j] === 0) return false;
                    if (i > 0 && grid[i][j] === grid[i - 1][j]) return false;
                    if (i < 3 && grid[i][j] === grid[i + 1][j]) return false;
                    if (j > 0 && grid[i][j] === grid[i][j - 1]) return false;
                    if (j < 3 && grid[i][j] === grid[i][j + 1]) return false;
                }
            }
            return true;
        }

        function restartGame() {
            score = 0;
            gameBoard.innerHTML = '';
            createBoard();
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowUp') moveTiles('up');
            if (e.key === 'ArrowDown') moveTiles('down');
            if (e.key === 'ArrowLeft') moveTiles('left');
            if (e.key === 'ArrowRight') moveTiles('right');
        });

        restartButton.addEventListener('click', restartGame);

        createBoard();
    </script>
</body>
</html>